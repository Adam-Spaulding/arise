{"version":3,"names":[],"mappings":"","sources":["controllers/task.js"],"sourcesContent":["'use strict';\n\napp.controller('TaskController', function($scope, $location, toaster, Task, Auth) {\n\n\tvar handleFileSelect = function(element, cb) {\n\t\tvar files = element.files;\n\t\tvar file = files[0];\n\t\tif (files && file) {\n\t\t\tvar reader = new FileReader();\n\t\t\treader.addEventListener('load', function () {\n\t\t\t\tvar image = new Image();\n\t\t\t\timage.height = 100;\n\t\t\t\timage.title = file.name;\n\t\t\t\timage.src = this.result;\n\t\t\t\tcb(this.result);\n\t\t\t}, false);\n\n\t\t\treader.readAsDataURL(file);\n\t\t}\n\t};\n\t$scope.createTask = function() {\n\t\t$scope.task.status = 'open';\n\t\t$scope.task.gravatar = Auth.user.profile.gravatar;\n\t\t$scope.task.name = Auth.user.profile.name;\n\t\t$scope.task.poster = Auth.user.uid;\n\n\t\tvar imgelement = document.getElementById('helpImg');\n\t\tif(imgelement.files.length>0){\n\t\t\thandleFileSelect(imgelement, function (data) {\n\t\t\t\t//console.log(data)\n\t\t\t\t$scope.task.img = data;\n\t\t\t\tTask.createTask($scope.task).then(function(ref) {\n\t\t\t\t\ttoaster.pop('success', 'Your call for help has been submitted.');\n\t\t\t\t\t$scope.task = {description: '', title: '', help_type: '', image: '', status: 'open', gravatar: '', name: '', poster: ''};\n\t\t\t\t\t$location.path('/browse' + ref.key());\n\t\t\t\t\t$('#posModal').modal('hide');\n\t\t\t\t});\n\t\t\t})\n\t\t}else{\n\t\t\tTask.createTask($scope.task).then(function(ref) {\n\t\t\t\ttoaster.pop('success', 'Your call for help has been submitted.');\n\t\t\t\t$scope.task = {description: '', title: '', help_type: '', image: '', status: 'open', gravatar: '', name: '', poster: ''};\n\t\t\t\t$location.path('/browse' + ref.key());\n\t\t\t\t$('#posModal').modal('hide');\n\t\t\t});\n\t\t}\n\n\t};\n\n\t$scope.editTask = function(task) {\n\t\tTask.editTask(task).then(function() {\n\t\t\ttoaster.pop('success', 'Your call for help has been updated.');\n\t\t\t$('#ediModal').modal('hide');\n\t\t});\n\t};\n\n});\n"],"file":"controllers/task.js","sourceRoot":"/source/"}